{"filter":false,"title":"continuous-integration.yml","tooltip":"/.github/workflows/continuous-integration.yml","undoManager":{"mark":37,"position":37,"stack":[[{"start":{"row":0,"column":0},"end":{"row":11,"column":5},"action":"remove","lines":["name: CI/CD","on:","  push:","    branches: [ main ]","","jobs:","  test_suite:","    runs-on: ubuntu-latest","    steps:","      - name: Checkout Branch","        uses: actions/checkout@v2","     "],"id":2},{"start":{"row":0,"column":0},"end":{"row":41,"column":0},"action":"insert","lines":["name: CI/CD","on:","  push:","    branches: [ master ]","","jobs:","  test_suite:","    runs-on: ubuntu-latest","    steps:","      - name: Checkout Branch","        uses: actions/checkout@v2","      - name: Set Up Python 3.8","        uses: actions/setup-python@v2","        with:","          python-version: 3.8","      - name: Install dependencies","        run: |","          python -m pip install --upgrade pip","          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi","      - name: Run Tests","        run: |","          python -m unittest discover tests/","  deployment:","    needs: test_suite","    runs-on: ubuntu-latest","    steps:","      - name: Fresh clone & repo install","        uses: appleboy/ssh-action@master","        with:","          #IP address of EC2 instance","          host: 54.83.97.145","          #User you created on the EC2 instance","          username: github-actions","          #Name of the secrets variable where you put your secret key","          key: $","          port: 22","          script: |","            rm -rf squiz","            git clone https://github.com/garretblankenship/squiz.git","            python3.8 -m venv /home/github-actions/squiz/venv","            /home/github-actions/squiz/venv/bin/pip3.8 install -r /home/github-actions/squiz/requirements.txt",""]}],[{"start":{"row":30,"column":17},"end":{"row":30,"column":28},"action":"remove","lines":["4.83.97.145"],"id":3},{"start":{"row":30,"column":17},"end":{"row":30,"column":30},"action":"insert","lines":["3.229.176.191"]}],[{"start":{"row":30,"column":16},"end":{"row":30,"column":30},"action":"remove","lines":["53.229.176.191"],"id":4}],[{"start":{"row":30,"column":16},"end":{"row":30,"column":29},"action":"insert","lines":["3.229.176.191"],"id":5}],[{"start":{"row":34,"column":15},"end":{"row":34,"column":16},"action":"remove","lines":["$"],"id":6}],[{"start":{"row":34,"column":15},"end":{"row":34,"column":52},"action":"insert","lines":["/Jisho/src/Otakujisho_key_May2022.pem"],"id":7}],[{"start":{"row":37,"column":19},"end":{"row":37,"column":24},"action":"remove","lines":["squiz"],"id":8},{"start":{"row":37,"column":18},"end":{"row":37,"column":19},"action":"remove","lines":[" "]}],[{"start":{"row":37,"column":18},"end":{"row":37,"column":19},"action":"insert","lines":[" "],"id":9},{"start":{"row":37,"column":19},"end":{"row":37,"column":20},"action":"insert","lines":["j"]},{"start":{"row":37,"column":20},"end":{"row":37,"column":21},"action":"insert","lines":["i"]},{"start":{"row":37,"column":21},"end":{"row":37,"column":22},"action":"insert","lines":["s"]},{"start":{"row":37,"column":22},"end":{"row":37,"column":23},"action":"insert","lines":["h"]},{"start":{"row":37,"column":23},"end":{"row":37,"column":24},"action":"insert","lines":["o"]}],[{"start":{"row":37,"column":24},"end":{"row":37,"column":25},"action":"insert","lines":["2"],"id":10}],[{"start":{"row":38,"column":22},"end":{"row":38,"column":68},"action":"remove","lines":["https://github.com/garretblankenship/squiz.git"],"id":11},{"start":{"row":38,"column":22},"end":{"row":38,"column":67},"action":"insert","lines":["https://github.com/joshlittlefield/jisho2.git"]}],[{"start":{"row":39,"column":51},"end":{"row":39,"column":56},"action":"remove","lines":["squiz"],"id":12},{"start":{"row":39,"column":51},"end":{"row":39,"column":52},"action":"insert","lines":["j"]},{"start":{"row":39,"column":52},"end":{"row":39,"column":53},"action":"insert","lines":["i"]},{"start":{"row":39,"column":53},"end":{"row":39,"column":54},"action":"insert","lines":["s"]},{"start":{"row":39,"column":54},"end":{"row":39,"column":55},"action":"insert","lines":["h"]},{"start":{"row":39,"column":55},"end":{"row":39,"column":56},"action":"insert","lines":["o"]},{"start":{"row":39,"column":56},"end":{"row":39,"column":57},"action":"insert","lines":["2"]}],[{"start":{"row":40,"column":33},"end":{"row":40,"column":34},"action":"insert","lines":["j"],"id":13},{"start":{"row":40,"column":34},"end":{"row":40,"column":35},"action":"insert","lines":["i"]},{"start":{"row":40,"column":35},"end":{"row":40,"column":36},"action":"insert","lines":["s"]},{"start":{"row":40,"column":36},"end":{"row":40,"column":37},"action":"insert","lines":["h"]},{"start":{"row":40,"column":37},"end":{"row":40,"column":38},"action":"insert","lines":["o"]},{"start":{"row":40,"column":38},"end":{"row":40,"column":39},"action":"insert","lines":["2"]}],[{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"remove","lines":["s"],"id":14},{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"remove","lines":["q"]},{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"remove","lines":["u"]},{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"remove","lines":["i"]},{"start":{"row":40,"column":39},"end":{"row":40,"column":40},"action":"remove","lines":["z"]}],[{"start":{"row":40,"column":88},"end":{"row":40,"column":89},"action":"insert","lines":["j"],"id":15},{"start":{"row":40,"column":89},"end":{"row":40,"column":90},"action":"insert","lines":["i"]},{"start":{"row":40,"column":90},"end":{"row":40,"column":91},"action":"insert","lines":["s"]},{"start":{"row":40,"column":91},"end":{"row":40,"column":92},"action":"insert","lines":["h"]},{"start":{"row":40,"column":92},"end":{"row":40,"column":93},"action":"insert","lines":["o"]},{"start":{"row":40,"column":93},"end":{"row":40,"column":94},"action":"insert","lines":["2"]}],[{"start":{"row":40,"column":94},"end":{"row":40,"column":95},"action":"remove","lines":["s"],"id":16},{"start":{"row":40,"column":94},"end":{"row":40,"column":95},"action":"remove","lines":["q"]},{"start":{"row":40,"column":94},"end":{"row":40,"column":95},"action":"remove","lines":["u"]},{"start":{"row":40,"column":94},"end":{"row":40,"column":95},"action":"remove","lines":["i"]},{"start":{"row":40,"column":94},"end":{"row":40,"column":95},"action":"remove","lines":["z"]}],[{"start":{"row":34,"column":15},"end":{"row":34,"column":52},"action":"remove","lines":["/Jisho/src/Otakujisho_key_May2022.pem"],"id":17}],[{"start":{"row":3,"column":18},"end":{"row":3,"column":19},"action":"insert","lines":["i"],"id":18},{"start":{"row":3,"column":19},"end":{"row":3,"column":20},"action":"insert","lines":["n"]}],[{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"remove","lines":["s"],"id":19},{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"remove","lines":["t"]},{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"remove","lines":["e"]},{"start":{"row":3,"column":20},"end":{"row":3,"column":21},"action":"remove","lines":["r"]}],[{"start":{"row":21,"column":38},"end":{"row":21,"column":39},"action":"insert","lines":["s"],"id":20},{"start":{"row":21,"column":39},"end":{"row":21,"column":40},"action":"insert","lines":["r"]},{"start":{"row":21,"column":40},"end":{"row":21,"column":41},"action":"insert","lines":["c"]},{"start":{"row":21,"column":41},"end":{"row":21,"column":42},"action":"insert","lines":["/"]}],[{"start":{"row":21,"column":41},"end":{"row":21,"column":42},"action":"remove","lines":["/"],"id":21},{"start":{"row":21,"column":40},"end":{"row":21,"column":41},"action":"remove","lines":["c"]},{"start":{"row":21,"column":39},"end":{"row":21,"column":40},"action":"remove","lines":["r"]},{"start":{"row":21,"column":38},"end":{"row":21,"column":39},"action":"remove","lines":["s"]}],[{"start":{"row":0,"column":0},"end":{"row":41,"column":0},"action":"remove","lines":["name: CI/CD","on:","  push:","    branches: [ main ]","","jobs:","  test_suite:","    runs-on: ubuntu-latest","    steps:","      - name: Checkout Branch","        uses: actions/checkout@v2","      - name: Set Up Python 3.8","        uses: actions/setup-python@v2","        with:","          python-version: 3.8","      - name: Install dependencies","        run: |","          python -m pip install --upgrade pip","          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi","      - name: Run Tests","        run: |","          python -m unittest discover tests/","  deployment:","    needs: test_suite","    runs-on: ubuntu-latest","    steps:","      - name: Fresh clone & repo install","        uses: appleboy/ssh-action@master","        with:","          #IP address of EC2 instance","          host: 3.229.176.191","          #User you created on the EC2 instance","          username: github-actions","          #Name of the secrets variable where you put your secret key","          key: ","          port: 22","          script: |","            rm -rf jisho2","            git clone https://github.com/joshlittlefield/jisho2.git","            python3.8 -m venv /home/github-actions/jisho2/venv","            /home/github-actions/jisho2/venv/bin/pip3.8 install -r /home/github-actions/jisho2/requirements.txt",""],"id":22},{"start":{"row":0,"column":0},"end":{"row":55,"column":0},"action":"insert","lines":["name: CI/CD","on:","  push:","    branches: [ main ]","","jobs:","  test_suite:","    runs-on: ubuntu-latest","    steps:","      - name: Checkout Branch","        uses: actions/checkout@v2","      - name: Set Up Python 3.9","        uses: actions/setup-python@v2","        with:","          python-version: 3.9","      - name: Install Dependencies","        run: |","          python -m pip install --upgrade pip","          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi","      - name: Run Tests","        env:","          FLASK_ENV: testing","          AWS_ACCESS_KEY_ID: 1","          AWS_SECRET_ACCESS_KEY: 1","          AWS_S3_BUCKET: 1","        run: |","          echo DB_URI=sqlite:///:memory: >> .env","          cd src","          python -m unittest discover tests/","","  deployment:","       needs: test_suite","       runs-on: ubuntu-latest","       steps:","         - name: Fresh clone & repo install","           uses: appleboy/ssh-action@master","           with:","             host: 54.234.137.7","             username: github-actions","             key: ${{ secrets.EC2 }}","             port: 22","             script: |","               rm -rf jisho","               git clone https://github.com/joshlittlefield/jisho.git","               python3 -m venv /home/github-actions/jisho/venv","               source /home/github-actions/jisho/venv/bin/activate","               pip install -r /home/github-actions/jisho/requirements.txt","               chmod +x /home/github-actions/jisho/script.sh","               /home/github-actions/jisho/./script.sh","               mv /home/github-actions/jisho/src/migrations /home/github-actions/jisho/","               cd /home/github-actions/jisho","               export FLASK_APP=src/main.py","               flask db-custom drop","               flask db upgrade","               flask db-custom seed",""]}],[{"start":{"row":37,"column":19},"end":{"row":37,"column":31},"action":"remove","lines":["54.234.137.7"],"id":23},{"start":{"row":37,"column":19},"end":{"row":37,"column":32},"action":"insert","lines":["3.229.176.191"]}],[{"start":{"row":42,"column":27},"end":{"row":42,"column":28},"action":"insert","lines":["2"],"id":24}],[{"start":{"row":43,"column":65},"end":{"row":43,"column":66},"action":"insert","lines":["2"],"id":25}],[{"start":{"row":44,"column":57},"end":{"row":44,"column":58},"action":"insert","lines":["2"],"id":26}],[{"start":{"row":45,"column":48},"end":{"row":45,"column":49},"action":"insert","lines":["2"],"id":27}],[{"start":{"row":46,"column":56},"end":{"row":46,"column":57},"action":"insert","lines":["2"],"id":28}],[{"start":{"row":47,"column":50},"end":{"row":47,"column":51},"action":"insert","lines":["2"],"id":29}],[{"start":{"row":48,"column":41},"end":{"row":48,"column":42},"action":"insert","lines":["2"],"id":30}],[{"start":{"row":49,"column":44},"end":{"row":49,"column":45},"action":"insert","lines":["2"],"id":31}],[{"start":{"row":50,"column":44},"end":{"row":50,"column":45},"action":"insert","lines":["2"],"id":32}],[{"start":{"row":26,"column":10},"end":{"row":26,"column":48},"action":"remove","lines":["echo DB_URI=sqlite:///:memory: >> .env"],"id":33}],[{"start":{"row":27,"column":10},"end":{"row":27,"column":16},"action":"remove","lines":["cd src"],"id":34},{"start":{"row":27,"column":8},"end":{"row":27,"column":10},"action":"remove","lines":["  "]},{"start":{"row":27,"column":6},"end":{"row":27,"column":8},"action":"remove","lines":["  "]},{"start":{"row":27,"column":4},"end":{"row":27,"column":6},"action":"remove","lines":["  "]},{"start":{"row":27,"column":2},"end":{"row":27,"column":4},"action":"remove","lines":["  "]},{"start":{"row":27,"column":0},"end":{"row":27,"column":2},"action":"remove","lines":["  "]}],[{"start":{"row":26,"column":10},"end":{"row":27,"column":0},"action":"remove","lines":["",""],"id":35}],[{"start":{"row":27,"column":9},"end":{"row":27,"column":10},"action":"insert","lines":["/"],"id":36},{"start":{"row":27,"column":10},"end":{"row":27,"column":11},"action":"insert","lines":["/"]}],[{"start":{"row":27,"column":10},"end":{"row":27,"column":11},"action":"remove","lines":["/"],"id":37},{"start":{"row":27,"column":9},"end":{"row":27,"column":10},"action":"remove","lines":["/"]}],[{"start":{"row":27,"column":10},"end":{"row":27,"column":44},"action":"remove","lines":["python -m unittest discover tests/"],"id":38},{"start":{"row":27,"column":8},"end":{"row":27,"column":10},"action":"remove","lines":["  "]},{"start":{"row":27,"column":6},"end":{"row":27,"column":8},"action":"remove","lines":["  "]},{"start":{"row":27,"column":4},"end":{"row":27,"column":6},"action":"remove","lines":["  "]},{"start":{"row":27,"column":2},"end":{"row":27,"column":4},"action":"remove","lines":["  "]},{"start":{"row":27,"column":0},"end":{"row":27,"column":2},"action":"remove","lines":["  "]}],[{"start":{"row":26,"column":10},"end":{"row":27,"column":0},"action":"remove","lines":["",""],"id":39}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":26,"column":10},"end":{"row":26,"column":10},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1652174717404,"hash":"d743189aec34b314d5fb853e5ac299de399dbdad"}